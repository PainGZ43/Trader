# 🔑 API 키 관리 요구사양서 (API Key Spec)

## 1. 개요 (Overview)
API 키 관리 시스템은 **실전투자**, **모의투자**, **가상투자** 세 가지 환경에 대한 계좌를 통합 관리합니다. 사용자는 이 시스템을 통해 거래 환경을 설정하고 계좌 정보를 등록/수정할 수 있습니다.

---

## 2. 투자 환경 및 등록 (Environment & Registration)

| 환경 (Environment) | 설명 (Description) | 필수 입력값 (Required Inputs) | 검증 로직 (Validation) |
| :--- | :--- | :--- | :--- |
| ** 실전투자 (Real)** | 실제 자금으로 거래하는 환경 | - 👤 **계좌이름**<br>- 🏦 **계좌번호**<br>- 🔑 **App Key**<br>- 🔒 **Secret Key** | 1. 실전 서버 접속 시도<br>2. 키 유효성 검증<br>3. **자동 업데이트**: 만료일|
| ** 모의투자 (Mock)** | 키움증권 모의투자 서버 환경 | - 👤 **계좌이름**<br>- 🏦 **계좌번호**<br>- 🔑 **App Key**<br>- 🔒 **Secret Key** | 1. 모의 서버 접속 시도<br>2. 키 유효성 검증<br>3. **자동 업데이트**: 만료일|
| ** 가상투자 (Virtual)** | 프로그램 내부 시뮬레이션 | - 👤 **계좌이름** | 1. **서버 접속 없음** (즉시 등록)<br>2. **계좌번호**: 자동 생성 (`VIRTUAL-XXXX`)<br>3. **만료일**: 무제한 (`9999-12-31`) |

---

## 3. 키 목록 및 관리 UI (Management UI)

### 📋 컬럼 구성 (Columns)
| 컬럼명 | 설명 | 비고 |
| :--- | :--- | :--- |
| **사용 (Use)** | 🔘 라디오 버튼 | 거래/시뮬레이션에 사용할 **활성 키** 선택 |
| **상태 (Status)** | ✅ 유효 / ❌ 무효 / ❓ 미확인 | API 접속 테스트 결과 |
> **확인 요청 사항**: 아래 질문들에 대한 답변을 주시면 구현에 반영하겠습니다.

1.  **계좌번호 검증 강제 여부**
    - *현재*: 서버가 정보를 반환하면 업데이트, 아니면 입력값 유지.
    - *질문*: 사용자가 입력한 계좌번호가 맞는지 **강제로 확인(Error 처리)** 
2.  **가상투자 계좌번호 수동 입력**
    - *현재*: `VIRTUAL-{UUID}` 자동 생성.
    - *질문*: 사용자가 가상 계좌번호를 **직접 입력** (예: `MY-TEST-ACC`)
3.  **자동 업데이트 범위**
    - *현재*: 유효성, 만료일 갱신.
    - *질문*: 추가로 갱신되어야 할 정보

---

## 5. 사용자 피드백 (Feedback)
. ⏰ 만료일 임박 알림 설정
내용: 키 만료 며칠 전부터 알림을 받을지 설정합니다 (기본 7일).
장점: 사용자가 원하는 시점에 미리 갱신 준비를 할 수 있습니다.
UI 변경: 설정 메뉴에 '만료 알림 시기(일)' 옵션 추가.
. 🚀 자동 로그인 계좌 지정
내용: 프로그램 시작 시 자동으로 로그인할 '기본 계좌'를 지정합니다.
장점: 매번 키를 선택할 필요 없이, 자주 쓰는 계좌로 즉시 시작할 수 있습니다.
UI 변경: 키 목록에 '자동 로그인' 체크박스 또는 라디오 버튼 기능 확장

---

## 6. 📊 계좌번호 기반 조회 가능 데이터 (Available Data)
계좌번호를 통해 서버(실전/모의)로부터 조회 가능한 상세 정보입니다.

| 구분 | 주요 데이터 | 관련 TR (예시) |
| :--- | :--- | :--- |
| **💰 예수금/자산** | - **예수금**: 주문/인출 가능 금액<br>- **총 매입금액**: 주식 매수 원금<br>- **총 평가금액**: 현재 가치 총액<br>- **총 손익**: 실현/평가 손익 합계 | `kt00004` (예수금현황)<br>`kt00001` (잔고현황) |
| **📦 보유 종목** | - **종목 리스트**: 코드/명칭<br>- **수량**: 보유/매매가능 수량<br>- **단가/현재가**: 평균단가, 현재가<br>- **수익률**: 종목별 손익/수익률 | `kt00018` (잔고)<br>`kt00001` (잔고현황) |
| **📝 주문 내역** | - **미체결**: 접수 후 대기 중인 주문<br>- **체결**: 당일 매수/매도 완료 내역 | `kt00007` (미체결)<br>`kt00009` (체결현황) |
